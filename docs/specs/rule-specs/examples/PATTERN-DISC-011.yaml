schema_version: 1

rule:
  id: "PATTERN-DISC-011"
  title: "Dependency Injection Pattern"
  description: |
    Discovers usage of the Dependency Injection pattern where dependencies are passed
    via constructor rather than created internally. Excludes simple data types.
  rationale: |
    Dependency Injection promotes loose coupling by injecting dependencies rather than
    having classes create them. Enables testing with mocks and improves flexibility.
  tier: 1
  category: "architectural"
  severity: "info"
  languages: [python]

  check:
    type: "pattern_discovery"
    patterns:
      - |
        class $CLASS:
          def __init__(self, $DEP):
            self.$FIELD = $DEP
    metavariable_regex:
      - metavariable: "$FIELD"
        regex: "^_.*"

  reporting:
    default_message: "Dependency Injection pattern detected. Dependencies are passed via constructor."
    confidence: "medium"
    documentation_url: null

  examples:
    good:
      - language: python
        code: |
          class RuleProcessor:
              def __init__(self, fetcher: RuleFetcher, cache: CacheManager):
                  self._fetcher = fetcher
                  self._cache = cache
    bad: []

  references:
    - "https://martinfowler.com/articles/injection.html"
